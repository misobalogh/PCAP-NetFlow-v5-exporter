packets = 0
octets = 0

data = {}
ref_data = {}


def parse_hex_data(hex_string):
    # Convert hex string to bytes
    byte_data = bytes.fromhex(hex_string)

    # header (first 24 bytes)
    version = int.from_bytes(byte_data[0:2], 'big')
    count = int.from_bytes(byte_data[2:4], 'big')
    sys_uptime = int.from_bytes(byte_data[4:8], 'big')
    unix_secs = int.from_bytes(byte_data[8:12], 'big')
    unix_nsecs = int.from_bytes(byte_data[12:16], 'big')
    flow_sequence = int.from_bytes(byte_data[16:20], 'big')

    # print(f"Version: {version}, Count: {count}, Sys Uptime: {sys_uptime}, Unix Seconds: {unix_secs}, Unix Nanoseconds: {unix_nsecs}, Flow Sequence: {flow_sequence},")

    # Parse each flow record
    for i in range(count):
        offset = 24 + i * 48  # 24 for header, 48 per flow record
        record = byte_data[offset:offset + 48]
        src_addr = '.'.join(str(b) for b in record[0:4])
        dst_addr = '.'.join(str(b) for b in record[4:8])
        nexthop = int.from_bytes(record[8:12], 'big')
        inp = int.from_bytes(record[12:14], 'big')
        outp = int.from_bytes(record[14:16], 'big')
        dPkts = int.from_bytes(record[16:20], 'big')
        dOctets = int.from_bytes(record[20:24], 'big')
        first = int.from_bytes(record[24:28], 'big')
        last = int.from_bytes(record[28:32], 'big')
        src_port = int.from_bytes(record[32:34], 'big')
        dst_port = int.from_bytes(record[34:36], 'big')
        pad1 = int.from_bytes(record[36:37], 'big')
        tcp_flags = int.from_bytes(record[37:38], 'big')
        prot = int.from_bytes(record[38:39], 'big')
        tos = int.from_bytes(record[39:40], 'big')
        src_as = int.from_bytes(record[40:42], 'big')
        dst_as = int.from_bytes(record[42:44], 'big')
        src_mask = int.from_bytes(record[44:45], 'big')
        dst_mask = int.from_bytes(record[45:46], 'big')
        pad2 = int.from_bytes(record[46:48], 'big')

        print(
            f"first: {first}, last: {last} dOctets: {dOctets}, dPkts: {dPkts}")

        if prot != 6:  # Only TCP
            continue

        flow_id = (src_addr, src_port, dst_addr, dst_port)
        data[flow_id] = {
            'first': first,
            'last': last,
            'dOctets': dOctets,
            'dPkts': dPkts
        }

        global packets
        global octets
        packets += dPkts
        octets += dOctets

        # print(f"{src_addr}:{src_port} -> {dst_addr}:{dst_port}, Packets: {dPkts}, Octets: {dOctets}")


def compare_data_with_ref(data, ref_data):
    matches = 0
    for flow_id, ref_record in ref_data.items():
        if flow_id in data:
            your_record = data[flow_id]
            if (your_record['dOctets'] == ref_record['dOctets'] and
                your_record['dPkts'] == ref_record['dPkts']):
                matches += 1
                my_time = your_record['last'] - your_record['first']
                ref_time = ref_record['last'] - ref_record['first']
                time_dif = abs(my_time - ref_time)
                print(f" time dif: {time_dif}")
            else:
                print(f"Discrepancy found for flow {flow_id}:")
                print(f"  Your Record: {your_record}")
                print(f"  Reference Record: {ref_record}")
        else:
            print(f"Flow {flow_id} not found in your data.")

    print(f"Matched {matches} flows out of {len(ref_data)}")


if __name__ == "__main__":
    # hex_data_prev = "0005001ebd0833216717eff22fb4064200000000000000007f0000017f000001000000000000000000000014000007e6bd082589bd083141dae018eb0018060000000000000000007f0000017f00000100000000000000000000000c000002a8bd082589bd08314118ebdae0001806000000000000000000c0a832368fccd68d00000000000000000000000100000034bd082a32bd082a32befa00500010060000000000000000008fccd68dc0a8323600000000000000000000000100000034bd082a4fbd082a4f0050befa001006000000000000000000c0a832364d4b4fde00000000000000000000004e000015dbbd082e57bd082fcae3a201bb001a060000000000000000004d4b4fdec0a8323600000000000000000000006000019dd5bd082e5fbd082fa201bbe3a2001a06000000000000000000c0a832360210024900000000000000000000000b00000a87bd082e91bd083262cdfe0050001a0600000000000000000002100249c0a8323600000000000000000000000a00001369bd082e99bd0832620050cdfe001a06000000000000000000c0a832364d4b4dde00000000000000000000000e000005e0bd082ec7bd082f0be5d201bb001f060000000000000000004d4b4ddec0a8323600000000000000000000000d000017b2bd082ed0bd082f0b01bbe5d2001b06000000000000000000c0a832362278d07b0000000000000000000000060000077fbd082f04bd08301a9e0e01bb0018060000000000000000002278d07bc0a8323600000000000000000000000700000213bd082f10bd082ff501bb9e0e001806000000000000000000c0a832364d4b4fc300000000000000000000000f0000063cbd082f76bd0831e4830e01bb001b06000000000000000000c0a832364d4b4fc30000000000000000000000ea000059a4bd082f76bd083320831601bb001a06000000000000000000c0a832364d4b4fc300000000000000000000001100000680bd082f82bd0831f3831801bb001f060000000000000000004d4b4fc3c0a832360000000000000000000001cf0008c666bd082f83bd08332101bb8316001a060000000000000000004d4b4fc3c0a8323600000000000000000000000b000018c6bd082f83bd0831e401bb830e001b060000000000000000004d4b4fc3c0a8323600000000000000000000000c00001910bd082f8bbd0831f301bb8318001b06000000000000000000c0a832364d4b4fc300000000000000000000001000000670bd082f90bd0831ee832601bb001e06000000000000000000c0a832364d4b4fc30000000000000000000000110000068cbd082f92bd083208832a01bb001f06000000000000000000c0a832364d4b4fc300000000000000000000001000000670bd082f94bd0831d9833601bb001b06000000000000000000c0a832364d4b4dc30000000000000000000000120000082dbd082f99bd0831dd9b1401bb001a060000000000000000004d4b4fc3c0a8323600000000000000000000000b000018dcbd082f9cbd0831ed01bb8326001a060000000000000000004d4b4fc3c0a8323600000000000000000000000c00001910bd082f9cbd08320801bb832a001b060000000000000000004d4b4fc3c0a8323600000000000000000000000c000018fabd082f9dbd0831d901bb8336001b060000000000000000004d4b4dc3c0a832360000000000000000000000160000539abd082fa3bd0831dd01bb9b14001a06000000000000000000c0a832364d4b4dc300000000000000000000000f0000063cbd082fafbd0831e49b1c01bb001b06000000000000000000c0a832364d4b4dc3000000000000000000000012000006b4bd082fb7bd0831fb9b2401bb001f06000000000000000000c0a832364d4b4fc300000000000000000000001100000674bd082fbcbd0831f3833e01bb001f06000000000000000000c0a832364d4b4fc30000000000000000000000110000068cbd082fbcbd0831e8834801bb001f06000000000000000000"

    # hex_data2_prev = "0005001ebd0833216717eff22fb5e9d00000001e000000004d4b4dc3c0a8323600000000000000000000000c000018fabd082fc0bd0831e401bb9b1c001b060000000000000000004d4b4dc3c0a8323600000000000000000000000d00001944bd082fc2bd0831fb01bb9b24001b06000000000000000000c0a832364d4b4dc3000000000000000000000012000006b4bd082fc3bd0831fa9b3401bb001f06000000000000000000c0a832364d4b4dc30000000000000000000000110000068cbd082fc3bd0831fb9b4401bb001f060000000000000000004d4b4fc3c0a8323600000000000000000000000c00001910bd082fc5bd0831f301bb833e001b060000000000000000004d4b4fc3c0a8323600000000000000000000000c00001910bd082fc5bd0831e801bb8348001b060000000000000000004d4b4dc3c0a8323600000000000000000000000d00001944bd082fccbd0831fa01bb9b34001b060000000000000000004d4b4dc3c0a8323600000000000000000000000c00001910bd082fccbd0831fb01bb9b44001b06000000000000000000c0a832364d4b4fc300000000000000000000002100000b1cbd082fe9bd08324a834a01bb001a060000000000000000004d4b4fc3c0a832360000000000000000000000310000d502bd082ff8bd08322201bb834a001a06000000000000000000c0a832364d4b4dc300000000000000000000001000000670bd082fffbd08320e9b4e01bb001b06000000000000000000c0a832364d4b4dc300000000000000000000000f0000063cbd082fffbd08320e9b5601bb001b06000000000000000000c0a832364d4b4dc300000000000000000000000f0000063cbd082fffbd08320e9b6401bb001b06000000000000000000c0a832364d4b4dc300000000000000000000001100000680bd082fffbd08320e9b7401bb001f06000000000000000000c0a832364d4b4dc300000000000000000000001000000658bd082fffbd0832089b7a01bb001f06000000000000000000c0a832364d4b4fc300000000000000000000001000000670bd083007bd08320e835001bb001b060000000000000000004d4b4dc3c0a8323600000000000000000000000b000018c6bd083013bd08320e01bb9b56001b060000000000000000004d4b4dc3c0a8323600000000000000000000000b000018dcbd083013bd08320e01bb9b4e001b060000000000000000004d4b4dc3c0a8323600000000000000000000000b000018c6bd083013bd08320e01bb9b64001b060000000000000000004d4b4dc3c0a8323600000000000000000000000d0000192ebd083013bd08320e01bb9b74001b060000000000000000004d4b4dc3c0a8323600000000000000000000000b000018dcbd083013bd08320801bb9b7a001b060000000000000000004d4b4fc3c0a8323600000000000000000000000b000018c6bd083014bd08320e01bb8350001b06000000000000000000c0a83236021002490000000000000000000000080000069dbd0831b6bd0832a0ce0e0050001a0600000000000000000002100249c0a8323600000000000000000000000700000bdcbd0831bebd0832a00050ce0e001a06000000000000000000c0a832364d4b4cd100000000000000000000002500000be8bd083222bd08329eb79601bb001a06000000000000000000c0a832364d4b4fc300000000000000000000000e00000608bd083223bd08326a835e01bb001b060000000000000000004d4b4fc3c0a8323600000000000000000000000c000018f1bd08322fbd08326a01bb835e001b060000000000000000004d4b4cd1c0a83236000000000000000000000042000128aabd08322fbd08329e01bbb796001a06000000000000000000c0a832364d4b4e680000000000000000000000120000078cbd083259bd0832e6bb4801bb001a060000000000000000004d4b4e68c0a83236000000000000000000000018000057d2bd083262bd0832be01bbbb48001a06000000000000000000"


    # hex_data = "0005001ebcec6b906717f70f158a939400000000000000007f0000017f000001000000000000000000000014000007e6bcec5df8bcec69b0dae018eb0018060000000000000000007f0000017f00000100000000000000000000000c000002a8bcec5df8bcec69b018ebdae0001806000000000000000000c0a832368fccd68d00000000000000000000000100000034bcec62a1bcec62a1befa00500010060000000000000000008fccd68dc0a8323600000000000000000000000100000034bcec62bebcec62be0050befa001006000000000000000000c0a832364d4b4fde00000000000000000000004e000015dbbcec66c6bcec6839e3a201bb001a060000000000000000004d4b4fdec0a8323600000000000000000000006000019dd5bcec66cebcec681101bbe3a2001a06000000000000000000c0a832360210024900000000000000000000000b00000a87bcec6700bcec6ad1cdfe0050001a0600000000000000000002100249c0a8323600000000000000000000000a00001369bcec6708bcec6ad10050cdfe001a06000000000000000000c0a832364d4b4dde00000000000000000000000e000005e0bcec6736bcec677ae5d201bb001f060000000000000000004d4b4ddec0a8323600000000000000000000000d000017b2bcec673fbcec677a01bbe5d2001b06000000000000000000c0a832362278d07b0000000000000000000000060000077fbcec6773bcec68899e0e01bb0018060000000000000000002278d07bc0a8323600000000000000000000000700000213bcec677fbcec686401bb9e0e001806000000000000000000c0a832364d4b4fc300000000000000000000000f0000063cbcec67e5bcec6a53830e01bb001b06000000000000000000c0a832364d4b4fc30000000000000000000000ea000059a4bcec67e5bcec6b8f831601bb001a06000000000000000000c0a832364d4b4fc300000000000000000000001100000680bcec67f1bcec6a62831801bb001f060000000000000000004d4b4fc3c0a832360000000000000000000001cf0008c666bcec67f2bcec6b9001bb8316001a060000000000000000004d4b4fc3c0a8323600000000000000000000000b000018c6bcec67f2bcec6a5301bb830e001b060000000000000000004d4b4fc3c0a8323600000000000000000000000c00001910bcec67fabcec6a6201bb8318001b06000000000000000000c0a832364d4b4fc300000000000000000000001000000670bcec67ffbcec6a5d832601bb001e06000000000000000000c0a832364d4b4fc30000000000000000000000110000068cbcec6801bcec6a77832a01bb001f06000000000000000000c0a832364d4b4fc300000000000000000000001000000670bcec6803bcec6a48833601bb001b06000000000000000000c0a832364d4b4dc30000000000000000000000120000082dbcec6808bcec6a4c9b1401bb001a060000000000000000004d4b4fc3c0a8323600000000000000000000000b000018dcbcec680bbcec6a5c01bb8326001a060000000000000000004d4b4fc3c0a8323600000000000000000000000c00001910bcec680bbcec6a7701bb832a001b060000000000000000004d4b4fc3c0a8323600000000000000000000000c000018fabcec680cbcec6a4801bb8336001b060000000000000000004d4b4dc3c0a832360000000000000000000000160000539abcec6812bcec6a4c01bb9b14001a06000000000000000000c0a832364d4b4dc300000000000000000000000f0000063cbcec681ebcec6a539b1c01bb001b06000000000000000000c0a832364d4b4dc3000000000000000000000012000006b4bcec6826bcec6a6a9b2401bb001f06000000000000000000c0a832364d4b4fc300000000000000000000001100000674bcec682bbcec6a62833e01bb001f06000000000000000000c0a832364d4b4fc30000000000000000000000110000068cbcec682bbcec6a57834801bb001f06000000000000000000"

    # hex_data2 = "0005001ebcec6b906717f70f158c06960000001e000000004d4b4dc3c0a8323600000000000000000000000c000018fabcec682fbcec6a5301bb9b1c001b060000000000000000004d4b4dc3c0a8323600000000000000000000000d00001944bcec6831bcec6a6a01bb9b24001b06000000000000000000c0a832364d4b4dc3000000000000000000000012000006b4bcec6832bcec6a699b3401bb001f06000000000000000000c0a832364d4b4dc30000000000000000000000110000068cbcec6832bcec6a6a9b4401bb001f060000000000000000004d4b4fc3c0a8323600000000000000000000000c00001910bcec6834bcec6a6201bb833e001b060000000000000000004d4b4fc3c0a8323600000000000000000000000c00001910bcec6834bcec6a5701bb8348001b060000000000000000004d4b4dc3c0a8323600000000000000000000000d00001944bcec683bbcec6a6901bb9b34001b060000000000000000004d4b4dc3c0a8323600000000000000000000000c00001910bcec683bbcec6a6a01bb9b44001b06000000000000000000c0a832364d4b4fc300000000000000000000002100000b1cbcec6858bcec6ab9834a01bb001a060000000000000000004d4b4fc3c0a832360000000000000000000000310000d502bcec6867bcec6a9101bb834a001a06000000000000000000c0a832364d4b4dc300000000000000000000001000000670bcec686ebcec6a7d9b4e01bb001b06000000000000000000c0a832364d4b4dc300000000000000000000000f0000063cbcec686ebcec6a7d9b5601bb001b06000000000000000000c0a832364d4b4dc300000000000000000000000f0000063cbcec686ebcec6a7d9b6401bb001b06000000000000000000c0a832364d4b4dc300000000000000000000001100000680bcec686ebcec6a7d9b7401bb001f06000000000000000000c0a832364d4b4dc300000000000000000000001000000658bcec686ebcec6a779b7a01bb001f06000000000000000000c0a832364d4b4fc300000000000000000000001000000670bcec6876bcec6a7d835001bb001b060000000000000000004d4b4dc3c0a8323600000000000000000000000b000018c6bcec6882bcec6a7d01bb9b56001b060000000000000000004d4b4dc3c0a8323600000000000000000000000b000018dcbcec6882bcec6a7d01bb9b4e001b060000000000000000004d4b4dc3c0a8323600000000000000000000000b000018c6bcec6882bcec6a7d01bb9b64001b060000000000000000004d4b4dc3c0a8323600000000000000000000000d0000192ebcec6882bcec6a7d01bb9b74001b060000000000000000004d4b4dc3c0a8323600000000000000000000000b000018dcbcec6882bcec6a7701bb9b7a001b060000000000000000004d4b4fc3c0a8323600000000000000000000000b000018c6bcec6883bcec6a7d01bb8350001b06000000000000000000c0a83236021002490000000000000000000000080000069dbcec6a25bcec6b0fce0e0050001a0600000000000000000002100249c0a8323600000000000000000000000700000bdcbcec6a2dbcec6b0f0050ce0e001a06000000000000000000c0a832364d4b4cd100000000000000000000002500000be8bcec6a91bcec6b0db79601bb001a06000000000000000000c0a832364d4b4fc300000000000000000000000e00000608bcec6a92bcec6ad9835e01bb001b060000000000000000004d4b4fc3c0a8323600000000000000000000000c000018f1bcec6a9ebcec6ad901bb835e001b060000000000000000004d4b4cd1c0a83236000000000000000000000042000128aabcec6a9ebcec6b0d01bbb796001a06000000000000000000c0a832364d4b4e680000000000000000000000120000078cbcec6ac8bcec6b55bb4801bb001a060000000000000000004d4b4e68c0a83236000000000000000000000018000057d2bcec6ad1bcec6b2d01bbbb48001a06000000000000000000"


    hex_data = "0005001ebcda486e6717fbb40067e0b000000000000000007f0000017f000001000000000000000000000014000007e6bcda3ad6bcda468edae018eb0018060000000000000000007f0000017f00000100000000000000000000000c000002a8bcda3ad6bcda468e18ebdae0001806000000000000000000c0a832368fccd68d00000000000000000000000100000034bcda3f7fbcda3f7fbefa00500010060000000000000000008fccd68dc0a8323600000000000000000000000100000034bcda3f9cbcda3f9c0050befa001006000000000000000000c0a832364d4b4fde00000000000000000000004e000015dbbcda43a4bcda4517e3a201bb001a060000000000000000004d4b4fdec0a8323600000000000000000000006000019dd5bcda43acbcda44ef01bbe3a2001a06000000000000000000c0a832360210024900000000000000000000000b00000a87bcda43debcda47afcdfe0050001a0600000000000000000002100249c0a8323600000000000000000000000a00001369bcda43e6bcda47af0050cdfe001a06000000000000000000c0a832364d4b4dde00000000000000000000000e000005e0bcda4414bcda4458e5d201bb001f060000000000000000004d4b4ddec0a8323600000000000000000000000d000017b2bcda441dbcda445801bbe5d2001b06000000000000000000c0a832362278d07b0000000000000000000000060000077fbcda4451bcda45679e0e01bb0018060000000000000000002278d07bc0a8323600000000000000000000000700000213bcda445dbcda454201bb9e0e001806000000000000000000c0a832364d4b4fc300000000000000000000000f0000063cbcda44c3bcda4731830e01bb001b06000000000000000000c0a832364d4b4fc30000000000000000000000ea000059a4bcda44c3bcda486d831601bb001a06000000000000000000c0a832364d4b4fc300000000000000000000001100000680bcda44cfbcda4740831801bb001f060000000000000000004d4b4fc3c0a832360000000000000000000001cf0008c666bcda44d0bcda486e01bb8316001a060000000000000000004d4b4fc3c0a8323600000000000000000000000b000018c6bcda44d0bcda473101bb830e001b060000000000000000004d4b4fc3c0a8323600000000000000000000000c00001910bcda44d8bcda474001bb8318001b06000000000000000000c0a832364d4b4fc300000000000000000000001000000670bcda44ddbcda473b832601bb001e06000000000000000000c0a832364d4b4fc30000000000000000000000110000068cbcda44dfbcda4755832a01bb001f06000000000000000000c0a832364d4b4fc300000000000000000000001000000670bcda44e1bcda4726833601bb001b06000000000000000000c0a832364d4b4dc30000000000000000000000120000082dbcda44e6bcda472a9b1401bb001a060000000000000000004d4b4fc3c0a8323600000000000000000000000b000018dcbcda44e9bcda473a01bb8326001a060000000000000000004d4b4fc3c0a8323600000000000000000000000c00001910bcda44e9bcda475501bb832a001b060000000000000000004d4b4fc3c0a8323600000000000000000000000c000018fabcda44eabcda472601bb8336001b060000000000000000004d4b4dc3c0a832360000000000000000000000160000539abcda44f0bcda472a01bb9b14001a06000000000000000000c0a832364d4b4dc300000000000000000000000f0000063cbcda44fcbcda47319b1c01bb001b06000000000000000000c0a832364d4b4dc3000000000000000000000012000006b4bcda4504bcda47489b2401bb001f06000000000000000000c0a832364d4b4fc300000000000000000000001100000674bcda4509bcda4740833e01bb001f06000000000000000000c0a832364d4b4fc30000000000000000000000110000068cbcda4509bcda4735834801bb001f06000000000000000000"


    hex_data2 = "0005001ebcda486e6717fbb400686fd80000001e000000004d4b4dc3c0a8323600000000000000000000000c000018fabcda450dbcda473101bb9b1c001b060000000000000000004d4b4dc3c0a8323600000000000000000000000d00001944bcda450fbcda474801bb9b24001b06000000000000000000c0a832364d4b4dc3000000000000000000000012000006b4bcda4510bcda47479b3401bb001f06000000000000000000c0a832364d4b4dc30000000000000000000000110000068cbcda4510bcda47489b4401bb001f060000000000000000004d4b4fc3c0a8323600000000000000000000000c00001910bcda4512bcda474001bb833e001b060000000000000000004d4b4fc3c0a8323600000000000000000000000c00001910bcda4512bcda473501bb8348001b060000000000000000004d4b4dc3c0a8323600000000000000000000000d00001944bcda4519bcda474701bb9b34001b060000000000000000004d4b4dc3c0a8323600000000000000000000000c00001910bcda4519bcda474801bb9b44001b06000000000000000000c0a832364d4b4fc300000000000000000000002100000b1cbcda4536bcda4797834a01bb001a060000000000000000004d4b4fc3c0a832360000000000000000000000310000d502bcda4545bcda476f01bb834a001a06000000000000000000c0a832364d4b4dc300000000000000000000001000000670bcda454cbcda475b9b4e01bb001b06000000000000000000c0a832364d4b4dc300000000000000000000000f0000063cbcda454cbcda475b9b5601bb001b06000000000000000000c0a832364d4b4dc300000000000000000000000f0000063cbcda454cbcda475b9b6401bb001b06000000000000000000c0a832364d4b4dc300000000000000000000001100000680bcda454cbcda475b9b7401bb001f06000000000000000000c0a832364d4b4dc300000000000000000000001000000658bcda454cbcda47559b7a01bb001f06000000000000000000c0a832364d4b4fc300000000000000000000001000000670bcda4554bcda475b835001bb001b060000000000000000004d4b4dc3c0a8323600000000000000000000000b000018c6bcda4560bcda475b01bb9b56001b060000000000000000004d4b4dc3c0a8323600000000000000000000000b000018dcbcda4560bcda475b01bb9b4e001b060000000000000000004d4b4dc3c0a8323600000000000000000000000b000018c6bcda4560bcda475b01bb9b64001b060000000000000000004d4b4dc3c0a8323600000000000000000000000d0000192ebcda4560bcda475b01bb9b74001b060000000000000000004d4b4dc3c0a8323600000000000000000000000b000018dcbcda4560bcda475501bb9b7a001b060000000000000000004d4b4fc3c0a8323600000000000000000000000b000018c6bcda4561bcda475b01bb8350001b06000000000000000000c0a83236021002490000000000000000000000080000069dbcda4703bcda47edce0e0050001a0600000000000000000002100249c0a8323600000000000000000000000700000bdcbcda470bbcda47ed0050ce0e001a06000000000000000000c0a832364d4b4cd100000000000000000000002500000be8bcda476fbcda47ebb79601bb001a06000000000000000000c0a832364d4b4fc300000000000000000000000e00000608bcda4770bcda47b7835e01bb001b060000000000000000004d4b4fc3c0a8323600000000000000000000000c000018f1bcda477cbcda47b701bb835e001b060000000000000000004d4b4cd1c0a83236000000000000000000000042000128aabcda477cbcda47eb01bbb796001a06000000000000000000c0a832364d4b4e680000000000000000000000120000078cbcda47a6bcda4833bb4801bb001a060000000000000000004d4b4e68c0a83236000000000000000000000018000057d2bcda47afbcda480b01bbbb48001a06000000000000000000"

    hex_data_ref = "0005001e000000006717ef9325cccdb800000000000000004d4b4ddec0a8323600000000000000000000000d000017b2bd09a282bd09a2c501bbe5d2001b06000000000000000000c0a832364d4b4dde00000000000000000000000e000005e0bd09a282bd09a2c5e5d201bb001f060000000000000000004d4b4fc3c0a8323600000000000000000000000c00001910bd09a33cbd09a5ae01bb8318001b06000000000000000000c0a832364d4b4fc300000000000000000000001100000680bd09a33cbd09a5ae831801bb001f060000000000000000004d4b4fc3c0a8323600000000000000000000000b000018dcbd09a34bbd09a5a801bb8326001a06000000000000000000c0a832364d4b4fc300000000000000000000001000000670bd09a34bbd09a5a8832601bb001e060000000000000000004d4b4fc3c0a8323600000000000000000000000c00001910bd09a34cbd09a5c301bb832a001b06000000000000000000c0a832364d4b4fc30000000000000000000000110000068cbd09a34cbd09a5c3832a01bb001f060000000000000000004d4b4dc3c0a8323600000000000000000000000d00001944bd09a372bd09a5b601bb9b24001b06000000000000000000c0a832364d4b4dc3000000000000000000000012000006b4bd09a372bd09a5b69b2401bb001f060000000000000000004d4b4fc3c0a8323600000000000000000000000c00001910bd09a376bd09a5ad01bb833e001b06000000000000000000c0a832364d4b4fc300000000000000000000001100000674bd09a376bd09a5ad833e01bb001f060000000000000000004d4b4fc3c0a8323600000000000000000000000c00001910bd09a377bd09a5a301bb8348001b06000000000000000000c0a832364d4b4fc30000000000000000000000110000068cbd09a377bd09a5a3834801bb001f060000000000000000004d4b4dc3c0a8323600000000000000000000000d00001944bd09a37ebd09a5b501bb9b34001b06000000000000000000c0a832364d4b4dc3000000000000000000000012000006b4bd09a37ebd09a5b59b3401bb001f060000000000000000004d4b4dc3c0a8323600000000000000000000000c00001910bd09a37ebd09a5b601bb9b44001b06000000000000000000c0a832364d4b4dc30000000000000000000000110000068cbd09a37ebd09a5b69b4401bb001f060000000000000000004d4b4dc3c0a8323600000000000000000000000d0000192ebd09a3babd09a5c801bb9b74001b06000000000000000000c0a832364d4b4dc300000000000000000000001100000680bd09a3babd09a5c89b7401bb001f060000000000000000004d4b4dc3c0a8323600000000000000000000000b000018dcbd09a3babd09a5c201bb9b7a001b06000000000000000000c0a832364d4b4dc300000000000000000000001000000658bd09a3babd09a5c29b7a01bb001f060000000000000000004d4b4fc3c0a8323600000000000000000000000b000018c6bd09a330bd09a59f01bb830e001b06000000000000000000c0a832364d4b4fc300000000000000000000000f0000063cbd09a330bd09a59f830e01bb001b060000000000000000004d4b4fc3c0a8323600000000000000000000000c000018fabd09a34ebd09a59301bb8336001b06000000000000000000c0a832364d4b4fc300000000000000000000001000000670bd09a34ebd09a593833601bb001b060000000000000000004d4b4dc3c0a8323600000000000000000000000c000018fabd09a36abd09a59f01bb9b1c001b06000000000000000000c0a832364d4b4dc300000000000000000000000f0000063cbd09a36abd09a59f9b1c01bb001b060000000000000000004d4b4dc3c0a8323600000000000000000000000b000018dcbd09a3b9bd09a5c801bb9b4e001b06000000000000000000c0a832364d4b4dc300000000000000000000001000000670bd09a3b9bd09a5c89b4e01bb001b06000000000000000000"

    hex_data_ref2 = "0005001e000000006717ef9325cccdb80000001e000000004d4b4dc3c0a8323600000000000000000000000b000018c6bd09a3b9bd09a5c801bb9b56001b06000000000000000000c0a832364d4b4dc300000000000000000000000f0000063cbd09a3b9bd09a5c89b5601bb001b060000000000000000004d4b4dc3c0a8323600000000000000000000000b000018c6bd09a3b9bd09a5c801bb9b64001b06000000000000000000c0a832364d4b4dc300000000000000000000000f0000063cbd09a3b9bd09a5c89b6401bb001b060000000000000000004d4b4fc3c0a8323600000000000000000000000b000018c6bd09a3c2bd09a5c801bb8350001b06000000000000000000c0a832364d4b4fc300000000000000000000001000000670bd09a3c2bd09a5c8835001bb001b060000000000000000004d4b4fc3c0a8323600000000000000000000000c000018f1bd09a5ddbd09a62501bb835e001b06000000000000000000c0a832364d4b4fc300000000000000000000000e00000608bd09a5ddbd09a625835e01bb001b060000000000000000008fccd68dc0a8323600000000000000000000000100000034bd099dedbd099e0a0050befa001006000000000000000000c0a832368fccd68d00000000000000000000000100000034bd099dedbd099e0abefa00500010060000000000000000004d4b4fdec0a8323600000000000000000000006000019dd5bd09a211bd09a38501bbe3a2001a06000000000000000000c0a832364d4b4fde00000000000000000000004e000015dbbd09a211bd09a385e3a201bb001a060000000000000000002278d07bc0a8323600000000000000000000000700000213bd09a2bebd09a3d501bb9e0e001806000000000000000000c0a832362278d07b0000000000000000000000060000077fbd09a2bebd09a3d59e0e01bb0018060000000000000000007f0000017f000001000000000000000000000014000007e6bd099943bd09a4fcdae018eb0018060000000000000000007f0000017f00000100000000000000000000000c000002a8bd099943bd09a4fb18ebdae000180600000000000000000002100249c0a8323600000000000000000000000a00001369bd09a24bbd09a61c0050cdfe001a06000000000000000000c0a832360210024900000000000000000000000b00000a87bd09a24bbd09a61ccdfe0050001a060000000000000000004d4b4fc3c0a832360000000000000000000001cf0008c666bd09a330bd09a6db01bb8316001a06000000000000000000c0a832364d4b4fc30000000000000000000000ea000059a4bd09a330bd09a6db831601bb001a060000000000000000004d4b4dc3c0a832360000000000000000000000160000539abd09a354bd09a59701bb9b14001a06000000000000000000c0a832364d4b4dc30000000000000000000000120000082dbd09a354bd09a5979b1401bb001a060000000000000000004d4b4fc3c0a832360000000000000000000000310000d502bd09a3a4bd09a60501bb834a001a06000000000000000000c0a832364d4b4fc300000000000000000000002100000b1cbd09a3a4bd09a605834a01bb001a0600000000000000000002100249c0a8323600000000000000000000000700000bdcbd09a571bd09a65b0050ce0e001a06000000000000000000c0a83236021002490000000000000000000000080000069dbd09a571bd09a65bce0e0050001a060000000000000000004d4b4cd1c0a83236000000000000000000000042000128aabd09a5ddbd09a65901bbb796001a06000000000000000000c0a832364d4b4cd100000000000000000000002500000be8bd09a5ddbd09a659b79601bb001a060000000000000000004d4b4e68c0a83236000000000000000000000018000057d2bd09a614bd09a6a101bbbb48001a06000000000000000000c0a832364d4b4e680000000000000000000000120000078cbd09a614bd09a6a1bb4801bb001a06000000000000000000"
    parse_hex_data(hex_data_ref)
    parse_hex_data(hex_data_ref2)
    octets_ref = octets
    packets_ref = packets
    data_ref = data

    print("\n\n")
    data = {}
    packets = 0
    octets = 0
    parse_hex_data(hex_data)
    parse_hex_data(hex_data2)
    if packets_ref == packets and octets_ref == octets:
        print("\nPacket and octet count match")

    compare_data_with_ref(data, data_ref)